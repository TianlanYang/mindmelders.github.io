<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="/dist/result.css" rel="stylesheet" />
    <style>
        .div_id2_1:hover+.div_id2_2 {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }

        .div_id3_1:hover+.div_id3_2 {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }

        .div_id4_1:hover+.div_id4_2 {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }

        .div_id5_1:hover+.div_id5_2 {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }

        .div_id6_1:hover+.div_id6_2 {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="container mx-auto justify-center items-center h-screen">
        <div href="#" class="absolute" style="top: 45%; left: 48%">
            <div class="flex">
                <button id="1" class="text-center rounded-full btn btn-neutral w-12 h-12 z-10"></button>
                <p class="absolute mt-20 active">Tianlan Yang</p>
            </div>
        </div>

        <!-- 上方绿色分支 -->
        <div href="#" class="absolute" style="top: 25%; left: 48%">
            <div class="flex div_id2_1">
                <button class="text-center rounded-full btn btn-success hover:bg-emerald-500 w-12 h-12 z-10"
                    id="2"></button>
                <p class="absolute ml-16 sport">Main1-sajkhjkfd</p>
            </div>

            <div class="hidden div_id2_2">
                <a href="#" class="absolute flex" style="top: -100%; left: -280%">
                    <button
                        class="text-center rounded-full btn btn-success hover:bg-emerald-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="2.1"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Communicatiosdfddsfddsfn
                    </p>
                </a>
                <a href="#" class="absolute flex" style="top: -250%; left: -160%">
                    <button
                        class="text-center rounded-full btn btn-success hover:bg-emerald-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="2.2"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Basketball
                    </p>
                </a>
                <a href="#" class="absolute flex" style="top: -300%; left: 10%">
                    <button
                        class="text-center rounded-full btn btn-success hover:bg-emerald-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="2.3"></button>
                    <p class="absolute ml-10 text-sm">Main1.33333</p>
                </a>
                <a href="#" class="absolute flex" style="top: -250%; left: 180%">
                    <button
                        class="text-center rounded-full btn btn-success hover:bg-emerald-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="2.4"></button>
                    <p class="absolute ml-10 text-sm">Main1.4</p>
                </a>
                <a href="#" class="absolute flex" style="top: -100%; left: 300%">
                    <button
                        class="text-center rounded-full btn btn-success hover:bg-emerald-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="2.5"></button>
                    <p class="absolute ml-10 text-sm">Main1.5</p>
                </a>
            </div>
        </div>

        <!-- 左边分支(黄色) -->
        <div href="#" class="absolute" style="left: 36%; top: 40%">
            <div class="flex div_id3_1">
                <button id="3"
                    class="text-center rounded-full btn btn-warning hover:bg-yellow-500 w-12 h-12 z-10"></button>
                <p class="absolute ml-16 Hobby" style="top: -80%">
                    Main2-sdfskljflk
                </p>
            </div>
            <div class="hidden div_id3_2">
                <a href=" #" class="absolute flex" style="top: -260%; left: -300%">
                    <button class="text-center rounded-full btn btn-warning hover:bg-yellow-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="3.1"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main2.1
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: -80%; left: -400%">
                    <button class="text-center rounded-full btn btn-warning hover:bg-yellow-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="3.2"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main2.2fdfgdfgdfg
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: 120%; left: -400%">
                    <button class="text-center rounded-full btn btn-warning hover:bg-yellow-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="3.3"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main2.3
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: 300%; left: -300%">
                    <button class="text-center rounded-full btn btn-warning hover:bg-yellow-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="3.4"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main2.4
                    </p>
                </a>
            </div>
        </div>

        <!-- 左下角分支（深绿色） -->
        <div href="#" class="absolute" id="4" style="left: 40%; top: 65%">
            <div class="flex div_id4_1">
                <button id="4" class="text-center rounded-full btn btn-accent w-12 h-12 z-10"></button>
                <p class="absolute mr-16 Hobby2" style="left: -150%;">
                    Other Option
                </p>
            </div>
            <div class="hidden div_id4_2">
                <a href=" #" class="absolute flex" style="top: 175%; left: -325%">
                    <button class="text-center rounded-full btn btn-accent w-4 h-8 min-w-0 min-h-0
                        z-20" id="4.1"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main3.1
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: 310%; left: -210%">
                    <button class="text-center rounded-full btn btn-accent w-4 h-8 min-w-0 min-h-0
                        z-20" id="4.2"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main3.2
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: 400%; left: -50%">
                    <button class="text-center rounded-full btn btn-accent w-4 h-8 min-w-0 min-h-0
                        z-20" id="4.3"></button>
                    <p class="absolute mr-16 text-sm w-16 h-16 break-all" style="left: -190%">
                        Main3.3
                    </p>
                </a>
            </div>
        </div>

        <!-- 右下角分支 -->
        <div href="#" class="absolute" id="5" style="right: 40%; top: 65%">
            <div class="flex div_id5_1">
                <button class="text-center rounded-full btn btn-error hover:bg-rose-500 w-12 h-12 z-10"></button>
                <p class="absolute ml-16 subject">Main4-henduohenduo</p>
            </div>
            <div class="hidden div_id5_2">
                <a href="#" class="absolute flex" style="top: 175%; right: -325%">
                    <button
                        class="text-center rounded-full btn btn-error hover:bg-rose-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="5.1"></button>
                    <p class="absolute ml-10 text-sm">Main4.1</p>
                </a>
                <a href="#" class="absolute flex" style="top: 310%; right: -210%">
                    <button
                        class="text-center rounded-full btn btn-error hover:bg-rose-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="5.2"></button>
                    <p class="absolute ml-10 text-sm">Main4.2</p>
                </a>
                <a href="#" class="absolute flex" style="top: 400%; right: -50%">
                    <button
                        class="text-center rounded-full btn btn-error hover:bg-rose-500 w-4 h-8 min-w-0 min-h-0 z-20"
                        id="5.3"></button>
                    <p class="absolute ml-10 text-sm">Main4.3</p>
                </a>
            </div>
        </div>

        <!-- 右边分支（蓝色） -->
        <div href="#" class="absolute" style="right: 36%; top: 40%">
            <div class="flex div_id6_1">
                <button id="6" class="text-center rounded-full btn btn-info hover:bg-sky-500 w-12 h-12 z-10"></button>
                <p class="absolute mr-16 career w-16 break-all" style="left: -150%; top: -80%;">Main5-hendduohenduo</p>
            </div>
            <div class="hidden div_id6_2">
                <a href=" #" class="absolute flex" style="top: -260%; right: -300%">
                    <button class="text-center rounded-full btn btn-info hover:bg-sky-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="6.1"></button>
                    <p class="absolute ml-10 text-sm">
                        Main5.1
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: -80%; right: -400%">
                    <button class="text-center rounded-full btn btn-info hover:bg-sky-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="6.2"></button>
                    <p class="absolute ml-10 text-sm">
                        Main5.2
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: 120%; right: -400%">
                    <button class="text-center rounded-full btn btn-info hover:bg-sky-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="6.3"></button>
                    <p class="absolute ml-10 text-sm">
                        Main5.3
                    </p>
                </a>
                <a href=" #" class="absolute flex" style="top: 300%; right: -300%">
                    <button class="text-center rounded-full btn btn-info hover:bg-sky-500 w-4 h-8 min-w-0 min-h-0
                        z-20" id="6.4"></button>
                    <p class="absolute ml-10 text-sm">
                        Main5.4
                    </p>
                </a>
            </div>
        </div>

        <!-- logout按钮 -->
        <div href="#" class="absolute" style="right: 2%; top: 3%;">
            <button class="btn btn-outline" onclick="my_modal_3.showModal()">&nbspLogout &nbsp</button>
            <dialog id="my_modal_3" class="modal modal-bottom sm:modal-middle">
                <form method="dialog" class="modal-box">
                  <h3 class="font-bold text-lg">Are you sure you want logout? You may lose all the information you filled before</h3>
                  <p class="py-4">(You can Press ESC key or click the "No" button below to close)</p>
                  <div class="modal-action">
                    <button class="btn">Yes</button>
                    <button class="btn">No</button>
                  </div>
                </form>
              </dialog>
        </div>

        <!-- 发送邮箱按钮 -->
        <div href="#" class="absolute" style="right: 2%; top: 12%;">
            <button class="btn btn-outline btn-success" onclick="my_modal_4.showModal()">Send PDF</button>
            <dialog id="my_modal_4" class="modal modal-bottom sm:modal-middle">
                <form method="dialog" class="modal-box">
                    <h3 class="font-bold text-lg">Are you sure you want to share and sent your pdf to your teacher?</h3>
                    <p class="py-4">(You can press ESC key or click the "No" option below to close)</p>
                    <div class="modal-action">
                        <button class="btn" onclick="my_modal_1.showModal()">Yes</button>
                        <dialog id="my_modal_1" class="modal">
                            <div class="alert alert-success max-w-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <span>Congratulation! Your result pdf has been sent!</span>
                            </div>
                        </dialog>
                        <button class="btn">No</button>
                    </div>
                </form>
            </dialog>
        </div>
    </div>


    <script>
        function createLineElement(x, y, length, angle) {
            var line = document.createElement("div");
            var styles =
                "border: 1px solid black; " +
                "width: " +
                length +
                "px; " +
                "height: 0px; " +
                "-moz-transform: rotate(" +
                angle +
                "rad); " +
                "-webkit-transform: rotate(" +
                angle +
                "rad); " +
                "-o-transform: rotate(" +
                angle +
                "rad); " +
                "-ms-transform: rotate(" +
                angle +
                "rad); " +
                "position: absolute; " +
                "top: " +
                y +
                "px; " +
                "left: " +
                x +
                "px; ";
            line.setAttribute("style", styles);
            return line;
        }

        function createLine(x1, y1, x2, y2) {
            var a = x1 - x2,
                b = y1 - y2,
                c = Math.sqrt(a * a + b * b);

            var sx = (x1 + x2) / 2,
                sy = (y1 + y2) / 2;

            var x = sx - c / 2,
                y = sy;

            var alpha = Math.PI - Math.atan2(-b, a);

            return createLineElement(x, y, c, alpha);
        }
        // 获取元素坐标
        function getElementOffset(element) {
            let offset = {
                left: 0,
                top: 0,
            };
            let current = element.offsetParent;

            offset.left += element.offsetLeft;
            offset.top += element.offsetTop;

            while (current !== null) {
                offset.left += current.offsetLeft;
                offset.top += current.offsetTop;
                current = current.offsetParent;
            }
            return offset;
        }

        let lineElements = [];

        function drawLine(id1, id2) {
            const lineId = id1 + "-" + id2;

            if (lineElements.includes(lineId)) {
                // Line already exists, do nothing
                return;
            }

            xy1 = getElementOffset(document.getElementById(id1));
            xy2 = getElementOffset(document.getElementById(id2));
            height1 = document.getElementById(id1).offsetHeight;
            w1 = document.getElementById(id1).offsetWidth;
            w2 = document.getElementById(id2).offsetWidth;
            lineElement = createLine(
                xy1.left + w1 / 2,
                xy1.top + height1,
                xy2.left + w2 / 2,
                xy2.top
            );
            lineElement.id = lineId;
            document.body.appendChild(lineElement);
            lineElements.push(lineId);
        }

        function removeLine(id1, id2) {
            const lineId = id1 + "-" + id2;
            const lineElement = document.getElementById(lineId);
            if (lineElement) {
                document.body.removeChild(lineElement);
                const index = lineElements.indexOf(lineId);
                if (index !== -1) {
                    //The array.splice(index, 1) method is used to modify an array by removing or replacing elements at a specific index.
                    lineElements.splice(index, 1);
                }
            }
        }

        drawLine("1", "2");
        drawLine("3", "1");
        drawLine("4", "1");
        drawLine("5", "1");
        drawLine("6", "1");

        const div_id2_1 = document.querySelector(".div_id2_1");
        const div_id2_2 = document.querySelector(".div_id2_2");

        const div_id3_1 = document.querySelector(".div_id3_1");
        const div_id3_2 = document.querySelector(".div_id3_2");

        const div_id4_1 = document.querySelector(".div_id4_1");
        const div_id4_2 = document.querySelector(".div_id4_2");

        const div_id5_1 = document.querySelector(".div_id5_1");
        const div_id5_2 = document.querySelector(".div_id5_2");

        const div_id6_1 = document.querySelector(".div_id6_1");
        const div_id6_2 = document.querySelector(".div_id6_2");

        div_id2_1.addEventListener("mouseenter", () => {
            div_id2_2.style.display = "block";
            drawLine("2.1", "2");
            drawLine("2.2", "2");
            drawLine("2.3", "2");
            drawLine("2.4", "2");
            drawLine("2.5", "2");
        });
        div_id2_1.addEventListener("click", () => {
            div_id2_2.style.display = "none";
            removeLine("2.1", "2");
            removeLine("2.2", "2");
            removeLine("2.3", "2");
            removeLine("2.4", "2");
            removeLine("2.5", "2");
        });

        div_id3_1.addEventListener("mouseenter", () => {
            div_id3_2.style.display = "block";
            drawLine("3.1", "3");
            drawLine("3.2", "3");
            drawLine("3.3", "3");
            drawLine("3.4", "3");
        });
        div_id3_1.addEventListener("click", () => {
            div_id3_2.style.display = "none";
            removeLine("3.1", "3");
            removeLine("3.2", "3");
            removeLine("3.3", "3");
            removeLine("3.4", "3");
        });

        div_id4_1.addEventListener("mouseenter", () => {
            div_id4_2.style.display = "block";
            drawLine("4", "4.1");
            drawLine("4", "4.2");
            drawLine("4", "4.3");
        });
        div_id4_1.addEventListener("click", () => {
            div_id4_2.style.display = "none";
            removeLine("4", "4.1");
            removeLine("4", "4.2");
            removeLine("4", "4.3");
        });

        div_id5_1.addEventListener("mouseenter", () => {
            div_id5_2.style.display = "block";
            drawLine("5", "5.1");
            drawLine("5", "5.2");
            drawLine("5", "5.3");
        });
        div_id5_1.addEventListener("click", () => {
            div_id5_2.style.display = "none";
            removeLine("5", "5.1");
            removeLine("5", "5.2");
            removeLine("5", "5.3");
        });

        div_id6_1.addEventListener("mouseenter", () => {
            div_id6_2.style.display = "block";
            drawLine("6.1", "6");
            drawLine("6.2", "6");
            drawLine("6.3", "6");
            drawLine("6.4", "6");
        });
        div_id6_1.addEventListener("click", () => {
            div_id6_2.style.display = "none";
            removeLine("6.1", "6");
            removeLine("6.2", "6");
            removeLine("6.3", "6");
            removeLine("6.4", "6");
        });
    </script>


    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";

        import { getDatabase, get, set, update, remove, ref, child, onValue }
            from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";


        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut
        }
            from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";


        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCkahzJE1QQxekDHPVHp4jM2CGS9MJuHyQ",
            authDomain: "stsa-compass.firebaseapp.com",
            projectId: "stsa-compass",
            storageBucket: "stsa-compass.appspot.com",
            messagingSenderId: "952259702189",
            appId: "1:952259702189:web:0c4104d466caf2e7974524"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase();
        const auth = getAuth(app);

        var username = localStorage.getItem('username');

        const studentName = document.querySelector(".active");
        const sport = document.querySelector(".sport");
        const Hobby = document.querySelector(".Hobby");
        const Hobby2 = document.querySelector(".Hobby2");
        const subject = document.querySelector(".subject");
        const career = document.querySelector(".career");

        const userListRef = ref(db, 'UserList/' + username + '/Answers');
        const sportRef = ref(db, 'UserList/' + username + '/Answers/Sport');
        const hobbyRef = ref(db, 'UserList/' + username + '/Answers/Hobby');
        const subjectRef = ref(db, 'UserList/' + username + '/Answers/Subject');
        const careertRef = ref(db, 'UserList/' + username + '/Answers/Career');
        const hobby2Ref = ref(db, 'UserList/' + username + '/Answers/Hobby2');


        get(sportRef).then((snapshot) => {
            if (snapshot.exists()) {
                const sportValue = snapshot.val();
                sport.textContent = sportValue;
            }
            else {
                console.log("No data available");
            }
        }).catch((error) => {
            console.error(error);
        });



        get(userListRef).then((snapshot) => {
            if (snapshot.exists()) {

                console.log("hhhhhhhh" + username);

                var data1 = snapshot.val();
                console.log(data1);

                // const dataName = data1.Name;
                studentName.textContent = username;
            }
            else {
                console.log("No data available");
            }
        }).catch((error) => {
            console.error(error);
        });


        get(hobbyRef).then((snapshot) => {
            if (snapshot.exists()) {
                const hobbyVal = snapshot.val();
                Hobby.textContent = hobbyVal;
            }
            else {
                console.log("No data available");
            }
        }).catch((error) => {
            console.error(error);
        });

        get(hobby2Ref).then((snapshot) => {
            if (snapshot.exists()) {
                const hobby2Val = snapshot.val();
                Hobby2.textContent = hobby2Val;
            }
            else {
                console.log("No data available");
            }
        }).catch((error) => {
            console.error(error);
        });


        get(subjectRef).then((snapshot) => {
            if (snapshot.exists()) {
                const subjectVal = snapshot.val();
                subject.textContent = subjectVal;
            }
            else {
                console.log("No data available");
            }
        }).catch((error) => {
            console.error(error);
        });

        get(careertRef).then((snapshot) => {
            if (snapshot.exists()) {
                const careerVal = snapshot.val();
                career.textContent = careerVal;
            }
            else {
                console.log("No data available");
            }
        }).catch((error) => {
            console.error(error);
        });
    </script>
</body>

</html>